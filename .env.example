# Database Configuration
POSTGRES_DB=tlsscanner
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme
DATABASE_URL=postgres://postgres:changeme@postgres/tlsscanner?sslmode=disable

# Redis Configuration
REDIS_URL=redis:6379

# API Configuration
# Internal API port is fixed at 8080

# Port Mappings
# Modify these if you have conflicting services on the host
POSTGRES_HOST_PORT=5432
REDIS_HOST_PORT=6379
API_HOST_PORT=8000
WEB_HOST_PORT=3000

# Gin Framework Mode (debug, test, release)
# Set to "release" for production
GIN_MODE=debug

# Scanner Configuration
SCAN_TIMEOUT=30
CONNECT_TIMEOUT=10
MAX_CONCURRENT_SCANS=10

# Custom CA Configuration
# Path on the host machine to directory containing custom CA certificates
# The scanner will trust certificates signed by these CAs
# HOST_CUSTOM_CA_PATH=./custom-ca
# SCANNER_VERBOSE=false

# Worker Configuration
WORKER_COUNT=3

# Domain Configuration (for production)
# DOMAIN=scanner.yourdomain.com

# Swagger Documentation Configuration
# Set this to your actual host:port for Swagger UI to work correctly
# Examples: 
#   SWAGGER_HOST=localhost:8000 (default for local development)
#   SWAGGER_HOST=scanner.yourdomain.com (for production with domain)
#   SWAGGER_HOST=192.168.1.100:8000 (for IP-based access)
SWAGGER_HOST=localhost:8000

# =============================================================================
# AUTHENTICATION CONFIGURATION
# =============================================================================

# Authentication Mode
# Options: none (default), optional, required
# - none: No authentication needed, all features public (jump box/internal network)
# - optional: Public scanning, admin features require auth
# - required: All features require authentication
AUTH_MODE=none

# Authentication Provider (only used when AUTH_MODE != none)
# Options: local, ldap
# AUTH_PROVIDER=local

# Allow anonymous scans when AUTH_MODE=optional
# ALLOW_ANONYMOUS_SCANS=true

# Enable user self-registration (only for AUTH_PROVIDER=local)
# ALLOW_USER_REGISTRATION=false

# Default admin email for initial setup
# DEFAULT_ADMIN_EMAIL=admin@company.com

# -----------------------------------------------------------------------------
# JWT Configuration (only used when AUTH_MODE != none)
# -----------------------------------------------------------------------------

# JWT signing secret - CHANGE THIS IN PRODUCTION!
# Generate with: openssl rand -base64 32
# JWT_SECRET=your-super-secret-jwt-key-change-this

# Token expiration times
# JWT_ACCESS_EXPIRY=15m
# JWT_REFRESH_EXPIRY=168h

# Password hashing cost (10-15, higher = more secure but slower)
# BCRYPT_COST=12

# -----------------------------------------------------------------------------
# LDAP/Active Directory Configuration (only used when AUTH_PROVIDER=ldap)
# -----------------------------------------------------------------------------

# LDAP Server URL
# For AD: ldap://dc01.company.local:389
# For LDAPS: ldaps://dc01.company.local:636
# LDAP_URL=ldap://ad.company.com:389

# Service account for LDAP binding (needs read access to users/groups)
# LDAP_BIND_DN=CN=svc_tlsscanner,CN=Users,DC=company,DC=com
# LDAP_BIND_PASSWORD=service-account-password

# LDAP search base
# LDAP_BASE_DN=DC=company,DC=com

# User search filter (%s will be replaced with username)
# For Active Directory (excludes disabled accounts):
# LDAP_USER_FILTER=(&(objectClass=user)(sAMAccountName=%s)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))
# For OpenLDAP:
# LDAP_USER_FILTER=(&(objectClass=inetOrgPerson)(uid=%s))

# Group membership filter (%s will be replaced with user DN)
# For AD with nested groups:
# LDAP_GROUP_FILTER=(&(objectClass=group)(member:1.2.840.113556.1.4.1941:=%s))
# For OpenLDAP:
# LDAP_GROUP_FILTER=(&(objectClass=groupOfNames)(member=%s))

# LDAP TLS Configuration
# LDAP_USE_TLS=true
# LDAP_TLS_SKIP_VERIFY=false
# LDAP_TLS_CA_CERT=/path/to/ca.crt

# AD/LDAP Group to Role Mapping
# Map your AD groups to TLS Scanner roles
# LDAP_GROUP_SUPER_ADMIN=CN=TLS_Scanner_SuperAdmins,CN=Groups,DC=company,DC=com
# LDAP_GROUP_ADMIN=CN=TLS_Scanner_Admins,CN=Groups,DC=company,DC=com
# LDAP_GROUP_OPERATOR=CN=TLS_Scanner_Operators,CN=Groups,DC=company,DC=com
# LDAP_GROUP_VIEWER=CN=Domain Users,CN=Groups,DC=company,DC=com

# LDAP user attribute mappings
# LDAP_ATTR_USERNAME=sAMAccountName
# LDAP_ATTR_EMAIL=mail
# LDAP_ATTR_DISPLAY_NAME=displayName

# -----------------------------------------------------------------------------
# Session Configuration
# -----------------------------------------------------------------------------

# Session timeout for web UI (when auth is enabled)
# SESSION_TIMEOUT=24h

# Remember me duration
# REMEMBER_ME_DURATION=720h

# =============================================================================
# HTTPS/TLS CONFIGURATION
# =============================================================================

# HTTPS Mode
# Options: http (default), https, auto
# - http: Plain HTTP only (for internal networks)
# - https: HTTPS with provided certificates
# - auto: Automatic HTTPS with Let's Encrypt
HTTPS_MODE=http

# Domain name for HTTPS (required for Let's Encrypt)
# DOMAIN_NAME=tlsscanner.example.com

# -----------------------------------------------------------------------------
# Let's Encrypt Configuration (only used when HTTPS_MODE=auto)
# -----------------------------------------------------------------------------

# Email for Let's Encrypt notifications
# LETSENCRYPT_EMAIL=admin@example.com

# Use Let's Encrypt staging server for testing
# LETSENCRYPT_STAGING=false

# -----------------------------------------------------------------------------
# Custom Certificate Configuration (only used when HTTPS_MODE=https)
# -----------------------------------------------------------------------------

# Paths to SSL certificate and key files (inside container)
# Place actual cert files in ./nginx/certs/ on your host machine
# SSL_CERT_PATH=/etc/nginx/certs/tlsscanner.crt
# SSL_KEY_PATH=/etc/nginx/certs/tlsscanner.key

# Optional: CA certificate chain for custom CA
# SSL_CA_CHAIN_PATH=/etc/nginx/certs/ca-chain.crt

# HTTPS port on host machine (default 3443 to avoid conflicts)
# WEB_HTTPS_PORT=3443

# -----------------------------------------------------------------------------
# Security Headers (applied when HTTPS is enabled)
# -----------------------------------------------------------------------------

# HTTP Strict Transport Security (HSTS)
# HSTS_MAX_AGE=31536000
# HSTS_INCLUDE_SUBDOMAINS=true
# HSTS_PRELOAD=false

# Content Security Policy
# CSP_ENABLED=true
# CSP_REPORT_ONLY=false

# =============================================================================
# ADMIN FEATURES CONFIGURATION
# =============================================================================

# Data retention settings (in days)
# SCAN_DATA_RETENTION_DAYS=90
# AUDIT_LOG_RETENTION_DAYS=365

# Automatic data pruning
# AUTO_PRUNE_ENABLED=false
# AUTO_PRUNE_SCHEDULE=0 2 * * *  # Cron format: 2 AM daily

# Export settings
# MAX_EXPORT_RECORDS=10000
# EXPORT_FORMAT=json  # Options: json, csv

# =============================================================================
# RATE LIMITING (when AUTH_MODE != none)
# =============================================================================

# Rate limiting for authentication endpoints
# LOGIN_RATE_LIMIT=5/1m  # 5 attempts per minute
# API_RATE_LIMIT=100/1m  # 100 requests per minute per user
# SCAN_RATE_LIMIT=10/1m  # 10 scans per minute per user

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# CORS settings for API access
# CORS_ENABLED=true
# CORS_ALLOWED_ORIGINS=https://tlsscanner.example.com,http://localhost:3000
# CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
# CORS_ALLOWED_HEADERS=Authorization,Content-Type,X-Requested-With
# CORS_ALLOW_CREDENTIALS=true
# CORS_MAX_AGE=86400